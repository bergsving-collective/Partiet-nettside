<!DOCTYPE html>
<html lang="no">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">

    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../fontawesome-free-6.4.0-web/css/all.min.css">
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
    <script src="../js/jquery-3.7.0.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicons/favicon-16x16.png">
    <link rel="manifest" href="../favicons/site.webmanifest">
    <script src="../js/script.js"></script>

    <title>Partiet - Artikler</title>
</head>

<body>
    <div id="navbar-placeholder"></div>
    <main>
        <section class="article-list">
            <div class="container">
                <h2 class="section-title">Artikler</h2>
                <div class="row" id="article-container">
                    <!-- Article boxes will be dynamically generated here -->
                </div>
            </div>
        </section>
    </main>

    <script>
        // Fetch the article files in the same folder
        fetchArticles();

        // Function to fetch the article files and generate article boxes
        function fetchArticles() {
            // Fetch the article files using a method of your choice (e.g., AJAX, Fetch API)
            // Replace the placeholder URL with the actual URL or adjust the method as needed
            fetch("./")
                .then(response => response.text())
                .then(data => {
                    const parser = new DOMParser();
                    const htmlDoc = parser.parseFromString(data, "text/html");
                    const articles = Array.from(htmlDoc.querySelectorAll("a[href$='.html']"));

                    // Log the fetched articles for debugging
                    console.log("Fetched articles:", articles);

                    // Generate article boxes
                    const articleContainer = document.getElementById("article-container");
                    articles.forEach(article => {
                        const articlePath = article.getAttribute("href");
                        const articleBox = createArticleBox(articlePath);
                        articleContainer.appendChild(articleBox);
                    });
                })
                .catch(error => {
                    console.error("Error fetching articles:", error);
                });
        }

        // Function to create an article box with provided article path
        function createArticleBox(articlePath) {
            const articleBox = document.createElement("div");
            articleBox.className = "col-md-6 pl-md-3 pr-md-3";
            articleBox.innerHTML = `
                <div class="article-box" onclick="location.href='${articlePath}';">
                    <div class="article-thumbnail">
                        <img src="images/garden.jpg" alt="Article Thumbnail">
                    </div>
                    <div class="article-content">
                        <h3 class="article-title">Loading...</h3>
                        <p class="article-subtitle">Loading...</p>
                        <p class="article-excerpt">Loading...</p>
                    </div>
                </div>
            `;

            // Fetch the article file to populate the article box content
            fetch(articlePath)
                .then(response => response.text())
                .then(data => {
                    const parser = new DOMParser();
                    const htmlDoc = parser.parseFromString(data, "text/html");

                    // Get the article title, subtitle, and excerpt
                    const title = htmlDoc.querySelector("h1").textContent;
                    const subtitle = htmlDoc.querySelector("h2").textContent;
                    const excerpt = htmlDoc.querySelector(".article-text").textContent;

                    // Update the article box content
                    const articleTitle = articleBox.querySelector(".article-title");
                    const articleSubtitle = articleBox.querySelector(".article-subtitle");
                    const articleExcerpt = articleBox.querySelector(".article-excerpt");
                    articleTitle.textContent = title;
                    articleSubtitle.textContent = subtitle;
                    articleExcerpt.textContent = excerpt;
                })
                .catch(error => {
                    console.error(`Error fetching article (${articlePath}):`, error);
                });

            return articleBox;
        }
    </script>

    <div id="footer-placeholder"></div>
</body>

</html>